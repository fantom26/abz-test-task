"use strict";(self.webpackChunkabz_test_task=self.webpackChunkabz_test_task||[]).push([[124],{5124:function(e,r,n){n.r(r),n.d(r,{default:function(){return V}});var a=n(2791),t=n(5089),s=n(5413),i=function(e){return e.position},o=function(e){return e.access},l=n(6568),c=function(e){return e.user},u=n(3998),h=n(184),d=function(e){var r=e.info,n=r.photo,a=r.name,t=r.position,s=r.email,i=r.phone;return(0,h.jsxs)("li",{className:"user",children:[(0,h.jsx)("div",{className:"user__img",children:n?(0,h.jsx)("img",{src:n,width:"70",height:"70",alt:"User's photo",loading:"lazy"}):u.Y.user}),(0,h.jsx)("div",{className:"user__name","data-title":a,children:(0,h.jsx)(l.ZT,{tag:"h3",center:!0,children:a})}),(0,h.jsx)("div",{className:"user__position","data-title":t,children:(0,h.jsx)(l.ZT,{tag:"p",center:!0,children:t})}),(0,h.jsx)("div",{className:"user__email","data-title":s,children:(0,h.jsx)(l.ZT,{tag:"p",center:!0,children:s})}),(0,h.jsx)(l.ZT,{tag:"p",center:!0,children:i})]})},m=function(){var e=(0,t.CG)(c).users;return(0,h.jsx)("ul",{className:"get__users",children:e.map((function(e){return(0,h.jsx)(d,{info:e},e.id)}))})},p=function(){var e=(0,t.$G)(),r=(0,t.CG)(c),n=r.page,s=r.limit,i=r.usersStatus,o=r.error,u=r.hasMore,d=(0,t.Fc)(),p=d.getUsers,x=d.incrementPage,f=function(){p({page:n,count:s}),x()};return(0,a.useEffect)((function(){"idle"===i&&f()}),[i]),(0,h.jsx)("section",{className:"get",id:"users",children:(0,h.jsxs)(l.W2,{children:[(0,h.jsx)(l.ZT,{tag:"h2",variant:"h1",center:!0,children:e.pages.home.get.title}),o&&(0,h.jsx)(l.ZT,{variant:"h1",className:"get__error",center:!0,children:o}),(0,h.jsx)(m,{}),"loading"!==i&&u&&(0,h.jsx)(l.zx,{onClick:f,children:e.btn.showMore}),"loading"===i&&(0,h.jsx)(l.aN,{})]})})},x=function(e){var r={heroBg1x:"/abz-test-task/img/hero/img@1x.avif",heroBg2x:"/abz-test-task/img/hero/img@2x.avif",heroBg1xMob:"/abz-test-task/img/hero/img@1x-mobile.avif",heroBg2xMob:"/abz-test-task/img/hero/img@2x-mobile.avif"};return r.hasOwnProperty(e)?r[e]:""},f=function(){return(0,h.jsx)("div",{className:"hero-bg",children:(0,h.jsxs)("picture",{children:[(0,h.jsx)("source",{srcSet:"".concat(x("heroBg1xMob")," 1x, ").concat(x("heroBg2xMob")," 2x"),type:"image/avif",media:"(max-width: 576px)"}),(0,h.jsx)("img",{src:x("heroBg1x"),srcSet:x("heroBg2x"),width:"1170",height:"650",loading:"lazy",alt:"Ukrainian lanscape"})]})})},g=function(){var e=(0,t.$G)();return(0,h.jsx)("section",{className:"hero",children:(0,h.jsx)(l.W2,{children:(0,h.jsxs)("div",{className:"hero-wrapper",children:[(0,h.jsx)(f,{}),(0,h.jsxs)("div",{className:"hero-info",children:[(0,h.jsx)(l.ZT,{tag:"h1",variant:"h1",color:"white",center:!0,children:e.pages.home.hero.title}),(0,h.jsx)(l.ZT,{tag:"p",color:"white",center:!0,children:e.pages.home.hero.description}),(0,h.jsx)(l.zx,{path:"#sign",hashLink:!0,children:e.navigation.signUp})]})]})})})},j=n(4165),v=n(9439),_=n(5861),b=n(4695),N=n(1413),Z=n(1134),w=n(4925),z=["value","onChange","error","helperText"],T=function(e){var r=e.value,n=e.onChange,a=e.error,t=e.helperText,s=(0,w.Z)(e,z);return(0,h.jsxs)("div",{className:function(){var e="form-file-upload ";return a&&(e+=" error"),r.length&&(e+=" load"),e}(),children:[(0,h.jsxs)("label",{className:"form-file-upload__wrapper",children:[(0,h.jsx)("input",(0,N.Z)({className:"visually-hidden",onChange:function(e){return n(e.target.files)},type:"file",value:r.filename,accept:".jpg,.jpeg"},s)),(0,h.jsx)("span",{className:"form-file-upload__btn",children:"Upload"}),(0,h.jsx)("span",{className:"form-file-upload__name",children:r.length?r[0].name:"Upload your photo"})]}),t&&(0,h.jsx)("span",{className:"form-error",children:t})]})},k=["placeholder","error","helperText"],X=["name","defaultValue","helperText","placeholder"],C=function(e){var r=e.placeholder,n=e.error,a=e.helperText,t=(0,w.Z)(e,k);return(0,h.jsxs)("div",{className:function(){var e="form-input ";return n&&(e+="error"),e}(),children:[(0,h.jsxs)("div",{className:"form-input__wrapper",children:[(0,h.jsx)("input",(0,N.Z)({className:"form-input__wrapper-input",type:"text",id:t.name,placeholder:" "},t)),(0,h.jsx)("label",{htmlFor:t.name,className:"form-input__label",children:r}),(0,h.jsx)("fieldset",{className:"form-input__fieldset",children:(0,h.jsx)("legend",{className:"form-input__legend",children:(0,h.jsx)("span",{children:r})})})]}),a&&(0,h.jsx)("span",{className:"".concat(n?"form-error":"form-text-helper"),children:a})]})},S=function(e){var r=e.methods,n=e.children,a=e.onSubmit;return(0,h.jsx)(Z.RV,(0,N.Z)((0,N.Z)({},r),{},{children:(0,h.jsx)("form",{onSubmit:a,children:n})}))};S.Input=function(e){var r=e.name,n=e.defaultValue,a=void 0===n?"":n,t=e.helperText,s=void 0===t?"":t,i=e.placeholder,o=void 0===i?"":i,l=(0,w.Z)(e,X),c=(0,Z.Gc)().control;return(0,h.jsx)(Z.Qr,{name:r,control:c,defaultValue:a,render:function(e){var r=e.field,n=e.fieldState.error;return(0,h.jsx)(C,(0,N.Z)({value:r.value||"",onChange:r.onChange,error:!!n,helperText:(null===n||void 0===n?void 0:n.message)||s,placeholder:o},l))}})},S.Radio=function(e){var r=e.label,n=e.value,a=e.name,t=(0,Z.Gc)().register;return(0,h.jsxs)("label",{className:"form-radio",children:[(0,h.jsx)("input",(0,N.Z)((0,N.Z)({},t(a)),{},{type:"radio",name:a,value:n})),(0,h.jsx)("span",{className:"form-radio__field"}),(0,h.jsx)("span",{className:"form-radio__label",children:r})]})},S.FileUpload=function(e){var r=e.name,n=(0,Z.Gc)().control;return(0,h.jsx)(Z.Qr,{name:r,control:n,defaultValue:[],render:function(e){var r=e.field,n=r.value,a=r.onChange,t=e.fieldState.error;return(0,h.jsx)(T,{value:n,onChange:a,error:!!t,helperText:null===t||void 0===t?void 0:t.message})}})};var y=n(4904),U=n(2797),G=function(e){var r=new Image;return new Promise((function(n,a){r.onload=function(){var e=r.naturalWidth,a=r.naturalHeight;n({width:e,height:a})},r.onerror=function(){a("There was some problem with the image.")},r.src=URL.createObjectURL(e)}))},R=function(){var e=(0,_.Z)((0,j.Z)().mark((function e(r){var n,a,t,s,i,o;return(0,j.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,v.Z)(r,1),a=n[0],t=!0,!a){e.next=9;break}return e.next=5,G(a);case 5:s=e.sent,i=s.width,o=s.height,(i>70||o>70)&&(t=!1);case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),F=(0,U.Ry)({name:(0,U.Z_)().min(2,"Name should be 2-60 characters").max(60,"Name should be 2-60 characters").required(),email:(0,U.Z_)().matches(/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/g,"Email must be a valid email according to RFC2822").required(),phone:(0,U.Z_)().min(13).max(13).matches(/^[+380]/g,"Phone must start +380").matches(/^[+]{0,1}380([0-9]{9})$/,"Phone isn't valid. Example +380XXXXXXXXX").required(),position_id:(0,U.Rx)().required(),photo:(0,U.nK)().required("You need to provide a file").test("is-big-file","Size must not exceed 5MB",(function(e){var r=(0,v.Z)(e,1)[0],n=!0;r&&(r.size/1024/1024>5&&(n=!1));return n})).test("is-resolution-correct","Resolution at least 70x70px",R).test("is-correct-type","User photo should be jpg/jpeg image",(function(e){var r=(0,v.Z)(e,1)[0],n=!0;return r&&(["image/jpeg","image/jpg"].includes(r.type)||(n=!1)),n}))}),B=function(){var e=(0,t.$G)(),r=(0,t.CG)(i).positions,n=(0,t.CG)(o).token,a=(0,t.Fc)().resetStoreUsers,s=(0,t.QT)().handleRequest,c=(0,Z.cI)({mode:"onChange",resolver:(0,b.X)(F)}),u=c.handleSubmit,d=c.formState,m=d.isSubmitting,p=d.isValid,x=c.reset,f=function(e){var r=new FileReader;r.onloadend=function(){var e;c.setValue("photo",null===(e=r.result)||void 0===e?void 0:e.toString())},r.readAsDataURL(e)},g=s(function(){var e=(0,_.Z)((0,j.Z)().mark((function e(r){var t,s,i,o,l,c,u;return(0,j.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new FormData,s=0,i=Object.entries(r);s<i.length;s++)o=(0,v.Z)(i[s],2),l=o[0],c=o[1],t.append(l,c);return t.set("photo",r.photo[0]),r.photo.length>0&&(r.photo=f(r.photo[0])),e.next=6,y.fz.addUser(t,n);case 6:if(!((u=e.sent).status<=200&&u.status>299)){e.next=9;break}throw new Error;case 9:x(),a();case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());return(0,h.jsx)(S,{methods:c,onSubmit:u(g),children:(0,h.jsxs)("div",{className:"post__form",children:[(0,h.jsx)(S.Input,{name:"name",placeholder:e.forms.name.placeholder}),(0,h.jsx)(S.Input,{name:"email",placeholder:e.forms.email.placeholder}),(0,h.jsx)(S.Input,{name:"phone",placeholder:e.forms.phone.placeholder,helperText:"+38 (XXX) XXX - XX - XX"}),(0,h.jsxs)("div",{className:"post__radio-group",children:[(0,h.jsx)(l.ZT,{tag:"p",children:"Select your position"}),null===r||void 0===r?void 0:r.map((function(e){return(0,h.jsx)(S.Radio,{label:e.name,name:"position_id",value:e.id},e.id)}))]}),(0,h.jsx)(S.FileUpload,{name:"photo"}),(0,h.jsx)(l.zx,{className:"post__form-btn",type:"submit",isLoading:m||!p,children:e.navigation.signUp})]})})},M=function(){var e=(0,t.$G)(),r=(0,t.CG)(c).userRegistered;return(0,h.jsx)("section",{className:"post",id:"sign",children:(0,h.jsxs)(l.W2,{children:[(0,h.jsx)(l.ZT,{tag:"h2",variant:"h1",center:!0,children:r?e.pages.home.post.titleSuccess:e.pages.home.post.title}),r?(0,h.jsx)("div",{className:"post__image",children:u.Y.success}):(0,h.jsx)(B,{})]})})},V=function(){var e=(0,t.CG)(i).positionsStatus,r=(0,t.CG)(o).tokenStatus,n=(0,s.F)(),l=n.getPositions,c=n.getTokenForRegistation;return(0,a.useEffect)((function(){"idle"===e&&l()}),[e]),(0,a.useEffect)((function(){"idle"===r&&c()}),[r]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g,{}),(0,h.jsx)(p,{}),(0,h.jsx)(M,{})]})}}}]);
//# sourceMappingURL=124.16179aa6.chunk.js.map